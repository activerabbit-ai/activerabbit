<% content_for :page_title do %>
  Plans & Pricing
<% end %>

<% if @account&.active_subscription? %>
  <div class="bg-indigo-50 border border-indigo-200 rounded-lg p-4 mb-6 mx-auto" style="width: 70%">
    <div class="flex items-center justify-between">
      <div>
        <h2 class="text-lg font-semibold text-indigo-900">Current Plan: <%= @account.current_plan&.titleize %></h2>
        <% if @events_remaining && @event_quota %>
          <p class="text-sm text-indigo-700">
            <%= number_with_delimiter(@events_remaining) %> events remaining on your <%= @account.current_plan&.titleize %> plan
          </p>
        <% end %>
        <% if @next_payment_date %>
          <p class="text-sm text-indigo-700">
            Next payment on <%= @next_payment_date %>
          </p>
        <% end %>
      </div>
      <div class="flex space-x-2">
        <%= button_to "View Invoices", billing_portal_index_path,
              method: :post, data: { turbo: false }, class: "inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700" %>
        <%= button_to "Manage Plan", billing_portal_index_path,
              method: :post, data: { turbo: false }, class: "inline-flex items-center px-3 py-1.5 border border-indigo-700 text-xs font-medium rounded-md shadow-sm text-indigo-700 bg-white hover:bg-indigo-50" %>
      </div>
    </div>
  </div>
<% end %>

<div class="space-y-6 mx-auto" style="width: 70%">
  <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
    <div class="group bg-white border rounded-xl p-6 shadow-sm flex flex-col transition-all duration-200 hover:shadow-xl hover:-translate-y-1 cursor-pointer">
      <h3 class="text-xl font-semibold">Developer</h3>
      <div class="mt-2">
        <span class="text-3xl font-extrabold tracking-tight text-gray-900">$25</span>
        <span class="text-sm text-gray-500">/mo</span>
        <span class="ml-2 inline-flex items-center rounded-full bg-indigo-50 px-2 py-0.5 text-xs font-medium text-indigo-700 ring-1 ring-inset ring-indigo-200">$250/yr</span>
      </div>
      <p class="text-gray-600 mt-1">50k events</p>
      <ul class="mt-4 space-y-2 text-sm text-gray-700">
        <li class="flex items-start"><svg class="w-4 h-4 text-indigo-600 mr-2 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/></svg><span>APM & error monitoring</span></li>
        <li class="flex items-start"><svg class="w-4 h-4 text-indigo-600 mr-2 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/></svg><span>Alerts & dashboards</span></li>
        <li class="flex items-start"><svg class="w-4 h-4 text-indigo-600 mr-2 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/></svg><span>Basic usage quotas</span></li>
      </ul>
      <div class="mt-auto pt-4">
        <%= button_to (@account&.current_plan == 'developer' ? "Current plan: Developer" : "Choose Developer"),
              checkouts_path,
              params: { plan: "developer", interval: "month", ai: false },
              data: { turbo: false }, method: :post,
              class: "w-full bg-indigo-600 text-white py-2 rounded-md hover:bg-indigo-700 transition-colors" %>
      </div>
    </div>

    <div class="group bg-white border rounded-xl p-6 shadow-sm flex flex-col ring-2 ring-indigo-500/20 transition-all duration-200 hover:shadow-xl hover:-translate-y-1 cursor-pointer">
      <h3 class="text-xl font-semibold">Team</h3>
      <div class="mt-2">
        <span class="text-3xl font-extrabold tracking-tight text-gray-900">$80</span>
        <span class="text-sm text-gray-500">/mo</span>
        <span class="ml-2 inline-flex items-center rounded-full bg-indigo-50 px-2 py-0.5 text-xs font-medium text-indigo-700 ring-1 ring-inset ring-indigo-200">$490/yr</span>
      </div>
      <p class="text-gray-600 mt-1">100k events</p>
      <ul class="mt-4 space-y-2 text-sm text-gray-700">
        <li class="flex items-start"><svg class="w-4 h-4 text-indigo-600 mr-2 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/></svg><span>Everything in Developer</span></li>
        <li class="flex items-start"><svg class="w-4 h-4 text-indigo-600 mr-2 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/></svg><span>Advanced alerts & automations</span></li>
        <li class="flex items-start"><svg class="w-4 h-4 text-indigo-600 mr-2 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/></svg><span>Higher usage quotas</span></li>
      </ul>
      <div class="mt-auto pt-4">
        <%= button_to (@account&.current_plan == 'team' ? "Current plan: Team" : "Choose Team"),
              checkouts_path,
              params: { plan: "team", interval: "month", ai: false },
              data: { turbo: false }, method: :post,
              class: "w-full bg-indigo-600 text-white py-2 rounded-md hover:bg-indigo-700 transition-colors" %>
      </div>
    </div>

      <div class="group bg-white border rounded-xl p-6 shadow-sm flex flex-col transition-all duration-200 hover:shadow-xl hover:-translate-y-1 cursor-pointer">
        <h3 class="text-xl font-semibold">Enterprise</h3>
        <div class="mt-2">
          <span class="text-3xl font-extrabold tracking-tight text-gray-900">$900</span>
          <span class="text-sm text-gray-500">/mo</span>
          <span class="ml-2 inline-flex items-center rounded-full bg-gray-100 px-2 py-0.5 text-xs font-medium text-gray-700 ring-1 ring-inset ring-gray-200">$9,000/yr</span>
        </div>
        <ul class="mt-4 space-y-2 text-sm text-gray-700">
          <li class="flex items-start"><svg class="w-4 h-4 text-indigo-600 mr-2 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/></svg><span>Custom quotas & SLAs</span></li>
          <li class="flex items-start"><svg class="w-4 h-4 text-indigo-600 mr-2 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/></svg><span>Priority support</span></li>
          <li class="flex items-start"><svg class="w-4 h-4 text-indigo-600 mr-2 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/></svg><span>Security reviews & SSO</span></li>
        </ul>
        <div class="mt-auto pt-4">
          <%= button_to (@account&.current_plan == 'enterprise' ? "Current plan: Enterprise" : "Talk to sales"),
                "mailto:sales@activerabbit.ai",
                method: :get, data: { turbo: false },
                class: "w-full bg-gray-900 text-white py-2 rounded-md hover:bg-gray-800" %>
        </div>
      </div>
  </div>

  <%= render "shared/upgrade_modal", account: @account if @account %>
</div>


