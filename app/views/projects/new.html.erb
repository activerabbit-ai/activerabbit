<% content_for :page_title do %>
  New Project
<% end %>

<% content_for :head do %>
  <style>
    .tech-stack-option {
      position: relative;
      overflow: hidden;
    }

    .tech-stack-option:hover {
      transform: translateY(-2px);
      border-color: #d1d5db;
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
    }

    .tech-stack-option.selected .tech-stack-indicator {
      opacity: 1;
    }

        .tech-stack-option.selected .tech-stack-overlay {
      background: linear-gradient(135deg, rgba(99, 102, 241, 0.05) 0%, rgba(139, 92, 246, 0.05) 100%);
    }

    .tech-stack-option.selected {
      box-shadow: 0 10px 25px -5px rgba(99, 102, 241, 0.4), 0 4px 6px -2px rgba(99, 102, 241, 0.2);
      border: 2px solid #6366f1;
      background-color: #fefefe;
    }

    .tech-stack-option.selected span:last-child {
      color: #4338ca !important;
      font-weight: 700;
    }

    .tech-stack-option.selected span:first-child {
      animation: bounce 0.6s ease-in-out;
    }

    @keyframes bounce {
      0%, 20%, 53%, 80%, 100% {
        transform: translate3d(0,0,0);
      }
      40%, 43% {
        transform: translate3d(0,-8px,0);
      }
      70% {
        transform: translate3d(0,-4px,0);
      }
      90% {
        transform: translate3d(0,-2px,0);
      }
    }
  </style>
<% end %>

<!-- Page Header -->
<div class="mb-8">
  <div>
    <h1 class="text-2xl font-bold text-gray-900">Create New Project</h1>
    <p class="text-gray-600 mt-1">Set up monitoring for a new application</p>
  </div>
</div>

<!-- Main Content -->
<div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
  <!-- Form Section -->
  <div class="lg:col-span-2">
    <div class="bg-white rounded-lg shadow p-6">
      <h2 class="text-lg font-medium text-gray-900 mb-6">Project Details</h2>

      <%= form_with model: @project, local: true, class: "space-y-6" do |form| %>

      <!-- Error Messages -->
      <% if @project.errors.any? %>
        <div class="bg-red-50 border border-red-200 rounded-lg p-4">
          <div class="flex">
            <div class="flex-shrink-0">
              <svg class="h-5 w-5 text-red-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.268 16.5c-.77.833.192 2.5 1.732 2.5z"></path>
              </svg>
            </div>
            <div class="ml-3">
              <h3 class="text-sm font-medium text-red-800">
                There were <%= pluralize(@project.errors.count, "error") %> with your submission:
              </h3>
              <div class="mt-2 text-sm text-red-700">
                <ul class="list-disc pl-5 space-y-1">
                  <% @project.errors.full_messages.each do |message| %>
                    <li><%= message %></li>
                  <% end %>
                </ul>
              </div>
            </div>
          </div>
        </div>
      <% end %>

              <!-- Project Name -->
        <div>
          <%= form.label :name, "Project Name", class: "block text-sm font-medium text-gray-700 mb-2" %>
          <%= form.text_field :name,
              placeholder: "My Rails App",
              class: "appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm" %>
          <% if @project.errors[:name].any? %>
            <p class="mt-1 text-sm text-red-600"><%= @project.errors[:name].first %></p>
          <% end %>
        </div>

        <!-- Project URL -->
        <div>
          <%= form.label :url, "Application URL", class: "block text-sm font-medium text-gray-700 mb-2" %>
          <%= form.url_field :url,
              placeholder: "https://myapp.com",
              class: "appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm" %>
          <p class="mt-1 text-xs text-gray-500">The URL where your Rails application is hosted</p>
          <% if @project.errors[:url].any? %>
            <p class="mt-1 text-sm text-red-600"><%= @project.errors[:url].first %></p>
          <% end %>
        </div>

              <!-- Project Description (Optional) -->
        <div>
          <%= form.label :description, "Description (Optional)", class: "block text-sm font-medium text-gray-700 mb-2" %>
          <%= form.text_area :description,
              rows: 3,
              placeholder: "Brief description of your project...",
              class: "appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm" %>
        </div>

        <!-- Tech Stack Selection -->
        <div>
          <%= form.label :tech_stack, "Tech Stack", class: "block text-sm font-medium text-gray-700 mb-3" %>
          <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-6" data-controller="tech-stack">
            <% tech_stacks = [
              { name: 'Ruby on Rails', icon: 'üíé', value: 'rails' },
              { name: 'Node.js', icon: 'üü¢', value: 'nodejs' },
              { name: 'React', icon: '‚öõÔ∏è', value: 'react' },
              { name: 'Vue.js', icon: 'üíö', value: 'vue' },
              { name: 'Django', icon: 'üêç', value: 'django' },
              { name: 'Laravel', icon: 'üî∂', value: 'laravel' },
              { name: 'Express.js', icon: 'üöÄ', value: 'express' },
              { name: 'Next.js', icon: '‚ñ≤', value: 'nextjs' },
              { name: 'Nuxt.js', icon: 'üíô', value: 'nuxt' },
              { name: 'Flask', icon: 'üå∂Ô∏è', value: 'flask' },
              { name: 'Spring Boot', icon: 'üçÉ', value: 'spring' },
              { name: 'Other', icon: '‚öôÔ∏è', value: 'other' }
            ] %>

                        <% tech_stacks.each do |stack| %>
                            <label class="tech-stack-option relative flex cursor-pointer rounded-xl bg-white p-6 shadow-md border border-gray-100 focus:outline-none hover:shadow-lg hover:scale-105 transition-all duration-200">
                <%= form.radio_button :tech_stack, stack[:value],
                    class: "sr-only",
                    data: { action: "change->tech-stack#select" } %>
                <div class="flex flex-col items-center text-center w-full relative z-10">
                  <span class="text-3xl mb-3 filter drop-shadow-sm"><%= stack[:icon] %></span>
                  <span class="text-sm font-semibold text-gray-700 leading-tight"><%= stack[:name] %></span>
                </div>
                <div class="tech-stack-indicator absolute -inset-px rounded-xl bg-gradient-to-r from-indigo-500 to-purple-600 opacity-0 pointer-events-none transition-opacity duration-200"></div>
                <div class="tech-stack-overlay absolute inset-0 rounded-xl pointer-events-none"></div>
              </label>
            <% end %>
          </div>
          <p class="mt-2 text-xs text-gray-500">Select the primary technology stack for this project</p>
        </div>

              <!-- Environment -->
        <div>
          <%= form.label :environment, "Environment", class: "block text-sm font-medium text-gray-700 mb-2" %>
          <%= form.select :environment,
              options_for_select([
                ['Production', 'production'],
                ['Staging', 'staging'],
                ['Development', 'development'],
                ['Testing', 'testing']
              ], 'production'),
              {},
              { class: "appearance-none relative block w-full px-3 py-2 border border-gray-300 text-gray-900 rounded-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm" } %>
          <p class="mt-1 text-xs text-gray-500">Select the primary environment for this project</p>
        </div>

        <!-- Actions -->
        <div class="flex items-center justify-between pt-6 border-t border-gray-200">
          <%= link_to dashboard_path,
              class: "text-sm text-gray-500 hover:text-gray-700" do %>
            ‚Üê Back to dashboard
          <% end %>

          <%= form.submit "Create Project & Get Started",
              class: "inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500" %>
        </div>
      <% end %>
    </div>
  </div>

  <!-- Info Section -->
  <div class="lg:col-span-1">
    <div class="bg-blue-50 border border-blue-200 rounded-lg p-6">
      <div class="flex">
        <div class="flex-shrink-0">
          <svg class="h-5 w-5 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
          </svg>
        </div>
        <div class="ml-3">
          <h3 class="text-sm font-medium text-blue-800">What happens next?</h3>
          <div class="mt-2 text-sm text-blue-700">
            <p>After creating your project, you'll be guided through installing the ActiveRabbit gem in your Rails application. This will enable automatic error tracking and performance monitoring.</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
